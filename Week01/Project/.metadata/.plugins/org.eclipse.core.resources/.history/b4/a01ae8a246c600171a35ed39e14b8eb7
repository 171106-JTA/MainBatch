package com.revature.model.account;

import java.util.Calendar;
import java.util.Date;
import java.util.concurrent.TimeUnit;

import com.revature.model.Constants;


public final class BasicUserAccount extends AdultUserAccount {

	/**
	 * 
	 */
	private static final long serialVersionUID = 2386161524991619034L;
	private static final int FIRST_RATE = 10;
	private static final int SECOND_RATE = 20;
	private static final int THIRD_RATE = 30;
	
	private static double interest = Constants.BASIC_INT_RATE_BELOW10;
	private static int limit = Constants.BASIC_CRED_LIMIT;
	private static int penalty = Constants.BASIC_USER_PENALTY;
	
	public BasicUserAccount() {
		super(limit, interest, penalty);
	}
	
	public BasicUserAccount(UserAccount from) {
		super(from.getUser(), from.getPass(), from.getAge(), 
				from.getBalance(), from.getInterest(), from.getLimit(), from.getLoans(),
				from.getPenalty(), from.getStart(), from.getStatus(), 
				from.getTransactions(), from.getUid());
		Date d = new Date();
		Calendar c = Calendar.getInstance();
		long millis = d.getTime() - from.getStart().getTime();
		c.setTimeInMillis(millis);
		int years = c.get(Calendar.YEAR);
		if(years > FIRST_RATE) {
			if(years > SECOND_RATE) {
				if(from.getInterest() < Constants.BASIC_INT_RATE_BELOW30)
					setInterest(Constants.BASIC_INT_RATE_BELOW30);
			}
			if(from.getInterest() < Constants.BASIC_INT_RATE_BELOW20)
				setInterest(Constants.BASIC_INT_RATE_BELOW20);
		}
		if(from.getInterest() < Constants.BASIC_INT_RATE_BELOW10)
			setInterest(Constants.BASIC_INT_RATE_BELOW10);
	}

	public void setInterest(double interest) {
		super.setInterest(interest);
	}

	@Override
	public String toString() {
		return "BasicUserAccount [limit=" + limit + ", penalty=" + penalty + ", status=" + status + ", interest="
				+ interest + ", permissions=" + permissions + "]";
	}

	
}
