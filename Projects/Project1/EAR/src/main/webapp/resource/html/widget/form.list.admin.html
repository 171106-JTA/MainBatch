<!--  ACCOUNT INFORMATION FOR EMPLOYEES  -->
<body>
	<script type="text/javascript">
			///
			//	INITIALIZERS
			///
	
			var initEventHandlers = function () {
				
				
				// Button event handlers 
				$("#listFilter").on("click", onFilterClick);
			}
			
			///
			//	HELPER METHODS 
			///
	
			var loadFormData = function () {
				var options;
				
				options = {
					"transtype": "GETALLFORMS"
				}
		
				debugger;
				Util.send(options, function (response) {
					
					if (response) {
						
						var table = $("#userFormTable");
						var row;
						
						// cache response
						table[0].forms = response
						
						// build user list 
						$.each(response, function (i, form){
							// Append work done to table 
							table.append(buildRow(form));
						});
					}
				});
			}
	
			
			var loadFilterData = function () {
				// Build select filter 
				Util.buildCodeList({
					"code" : "STATUS",
					"node" : $("#applicationStatus"),
					"display" : "value description"
				});
				
				// Build select filter 
				Util.buildCodeList({
					"code" : "DEPARTMENT",
					"node" : $("#applicationDepartment"),
					"display" : "value description"
				});
				
				Util.buildCodeList({
					"code" : "USER-ROLE",
					"node" : $("#applicationRole"),
					"display" : "value"
				});
			}
	
			var buildRow = function (form) {
				var row;
				
				// Assemble data
				row = $("<tr></tr>");
				row.append($("<td>" + form.formId + "</td>"));
				row.append($("<td>" + form.status + "</td>"));
				row.append($("<td>" + form.department + "</td>"));
				row.append($("<td>" + form.firstName + " " + form.lastName + "</td>"));
				row.append($("<td>" + form.eventDateTimeStart + "</td>"));
				row.append($("<td>" + form.eventDateTimeEnd + "</td>"));
				
				return row;
			}
			
			///
			//	EVENT HANDLERS
			///
			
			var onFilterClick = function () {
				var table = $("#userFormTable")
				var forms = table[0].forms;
				var status = $("#applicationStatus").val();
				var department = $("#applicationDepartment").val();
				var head = $(table.find("tr")[0]).clone(true);
				var rowOk;

				// clean table
				table.empty();
				table.append(head);
				
				$.each(forms, function (i, form){
					rowOk = true;
					rowOk = status ? form.status === status : rowOk;
					rowOk = department ? (rowOk && form.department === department) : rowOk;
					
					if (rowOk)
						table.append(buildRow(form));					
				});
				
			}
			
			///
			//	EXECUTE
			///
			
			execute = function(type) {
				if (type === "screen") {
					loadFormData();
					loadFilterData();
					initEventHandlers();
					
					// Build info icons
					Util.buildInfoIcons($("div[is-drawer]"));
					Util.buildInfoIcons($("div[is-screen]"));
				}
			}
		</script>
		
	<div is-drawer>
		<div class="row">
			<div class="col-xs-12">
				<label>Status:<span info-icon="Filter by application status"></span></label>
				<select id="applicationStatus" class="form-control"></select>
			</div>
		</div>
		<div class="row">
			<div class="col-xs-12">
				<label>Department:<span info-icon="Filter application by department"></span></label>
				<select id="applicationDepartment" class="form-control"></select>
			</div>
		</div>
			
		<!-- SPLIT  -->
		<div style="height: 5px; padding-top: 5px; padding-bottom: 5px;">
			<hr class="hr-divider" style="margin: 0px;">
		</div>
		
		<div class="row">
			<div class="col-xs-12">
				<button id="listFilter" class="btn-primary form-control"><span class="fa fa-search"></span> Filter</button>
			</div>
		</div>
	</div>
	

	<div is-screen>
		<style>
			.user-info-block {
				overflow-x: hidden;
				padding-top: 25px;
			}
			
			.info-table-max-width {
				max-width: 600px;
			}
			
			.info-table {
				width: 100%;
				border: 1px solid rgba(40, 40, 40, 0.25);
				margin-bottom: 5px;
			}
			
			.info-table th {
				background-color: #0082ff;
				width: 125px;
				color: #eeeeee;
			}
			
			.info-table b {
				padding-left: 5px;
			}
			
			.info-table td {
				border: 1px solid rgba(40, 40, 40, 0.25);
			}
		</style>

		<!-- USED TO DISPLAY ACCOUNT INFORMATION -->
		<div class="user-info-block">
			<div class="info-table-max-width center-block">
				<div class="text-center">
					<label style="font-size: 2.0em">Submitted Forms</label>
				</div>
				
				<table id="userFormTable" class="info-table">
					<tr>
						<th>Form ID</th><th>STATUS</th><th>DEPARTMENT</th><th>WHO</th><th>EVENT START</th><th>EVENT END</th>
					</tr>
				</table>
			</div>
		</div>
	</div>
</body>